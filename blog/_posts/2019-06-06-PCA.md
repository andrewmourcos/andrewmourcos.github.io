---
layout: projects
title: Using PCA and K-means for Clustering
tag: tutorial, data, python
description: Learning about Principal Component Analysis and it's utility in dimension reduction
img: /Media/blog/pca/output_24_0.png
---

In this post, I want to give an example of how you might deal with multidimensional data. As a use-case, I will be trying to cluster different types of wine in an unsupervised method.

Let's start by importing some packages. I will be using sklearn's PCA methods (dimension reduction), K-mean methods (clustering data points) and one of their built-in datasets (for convenience). I will also be using pandas' dataframe object to store my dataset and matplotlib for visualizations


```python
from sklearn.cluster import KMeans # Our clustering algorithm
from sklearn.decomposition import PCA # Needed for dimension reduction
from sklearn.datasets import load_wine # Dataset that I will be using
import matplotlib.pyplot as plt # Plotting 
import pandas as pd # Storing data convenieniently
```

For the sake of this example, I will be using sci-kit learn's built-in dataset of wines, so let's load that data into a dataframe. I encourage you to try your own dataset for this tutorial.


```python
wines = load_wine()
wine_df = pd.DataFrame(wines.data, columns=wines.feature_names)
```

I'm curious to see what the data looks like, so I will display the first 5 rows of the dataframe.


```python
wine_df.head(5)
```




<div class="table">
	<style scoped>
		table{
			width:100px;
			overflow:hidden;
		}

	    .dataframe tbody tr th:only-of-type {
	        vertical-align: middle;
	    }

	    .dataframe tbody tr th {
	        vertical-align: top;
	    }

	    .dataframe thead th {
	        text-align: right;
	    }
	</style>
	<table border="1" class="dataframe">
	  <thead>
	    <tr style="text-align: right;">
	      <th></th>
	      <th>alcohol</th>
	      <th>malic_acid</th>
	      <th>ash</th>
	      <th>alcalinity_of_ash</th>
	      <th>magnesium</th>
	      <th>total_phenols</th>
	      <th>flavanoids</th>
	      <th>nonflavanoid_phenols</th>
	      <th>proanthocyanins</th>
	      <th>color_intensity</th>
	      <th>hue</th>
	      <th>od280/od315_of_diluted_wines</th>
	      <th>proline</th>
	    </tr>
	  </thead>
	  <tbody>
	    <tr>
	      <th>0</th>
	      <td>14.23</td>
	      <td>1.71</td>
	      <td>2.43</td>
	      <td>15.6</td>
	      <td>127.0</td>
	      <td>2.80</td>
	      <td>3.06</td>
	      <td>0.28</td>
	      <td>2.29</td>
	      <td>5.64</td>
	      <td>1.04</td>
	      <td>3.92</td>
	      <td>1065.0</td>
	    </tr>
	    <tr>
	      <th>1</th>
	      <td>13.20</td>
	      <td>1.78</td>
	      <td>2.14</td>
	      <td>11.2</td>
	      <td>100.0</td>
	      <td>2.65</td>
	      <td>2.76</td>
	      <td>0.26</td>
	      <td>1.28</td>
	      <td>4.38</td>
	      <td>1.05</td>
	      <td>3.40</td>
	      <td>1050.0</td>
	    </tr>
	    <tr>
	      <th>2</th>
	      <td>13.16</td>
	      <td>2.36</td>
	      <td>2.67</td>
	      <td>18.6</td>
	      <td>101.0</td>
	      <td>2.80</td>
	      <td>3.24</td>
	      <td>0.30</td>
	      <td>2.81</td>
	      <td>5.68</td>
	      <td>1.03</td>
	      <td>3.17</td>
	      <td>1185.0</td>
	    </tr>
	    <tr>
	      <th>3</th>
	      <td>14.37</td>
	      <td>1.95</td>
	      <td>2.50</td>
	      <td>16.8</td>
	      <td>113.0</td>
	      <td>3.85</td>
	      <td>3.49</td>
	      <td>0.24</td>
	      <td>2.18</td>
	      <td>7.80</td>
	      <td>0.86</td>
	      <td>3.45</td>
	      <td>1480.0</td>
	    </tr>
	    <tr>
	      <th>4</th>
	      <td>13.24</td>
	      <td>2.59</td>
	      <td>2.87</td>
	      <td>21.0</td>
	      <td>118.0</td>
	      <td>2.80</td>
	      <td>2.69</td>
	      <td>0.39</td>
	      <td>1.82</td>
	      <td>4.32</td>
	      <td>1.04</td>
	      <td>2.93</td>
	      <td>735.0</td>
	    </tr>
	  </tbody>
	</table>
</div>



We can see that each wine (row) is described with 13 features including alcohol percentage, alcalinity, etc. We can do a few more tricks with pandas to get a general insight into the dataset.


```python
wine_df.describe()
```

<div class="table">
	<style scoped>
	    .dataframe tbody tr th:only-of-type {
	        vertical-align: middle;
	    }

	    .dataframe tbody tr th {
	        vertical-align: top;
	    }

	    .dataframe thead th {
	        text-align: right;
	    }
	</style>
	<table border="1" class="dataframe">
	  <thead>
	    <tr style="text-align: right;">
	      <th></th>
	      <th>alcohol</th>
	      <th>malic_acid</th>
	      <th>ash</th>
	      <th>alcalinity_of_ash</th>
	      <th>magnesium</th>
	      <th>total_phenols</th>
	      <th>flavanoids</th>
	      <th>nonflavanoid_phenols</th>
	      <th>proanthocyanins</th>
	      <th>color_intensity</th>
	      <th>hue</th>
	      <th>od280/od315_of_diluted_wines</th>
	      <th>proline</th>
	    </tr>
	  </thead>
	  <tbody>
	    <tr>
	      <th>count</th>
	      <td>178.000000</td>
	      <td>178.000000</td>
	      <td>178.000000</td>
	      <td>178.000000</td>
	      <td>178.000000</td>
	      <td>178.000000</td>
	      <td>178.000000</td>
	      <td>178.000000</td>
	      <td>178.000000</td>
	      <td>178.000000</td>
	      <td>178.000000</td>
	      <td>178.000000</td>
	      <td>178.000000</td>
	    </tr>
	    <tr>
	      <th>mean</th>
	      <td>13.000618</td>
	      <td>2.336348</td>
	      <td>2.366517</td>
	      <td>19.494944</td>
	      <td>99.741573</td>
	      <td>2.295112</td>
	      <td>2.029270</td>
	      <td>0.361854</td>
	      <td>1.590899</td>
	      <td>5.058090</td>
	      <td>0.957449</td>
	      <td>2.611685</td>
	      <td>746.893258</td>
	    </tr>
	    <tr>
	      <th>std</th>
	      <td>0.811827</td>
	      <td>1.117146</td>
	      <td>0.274344</td>
	      <td>3.339564</td>
	      <td>14.282484</td>
	      <td>0.625851</td>
	      <td>0.998859</td>
	      <td>0.124453</td>
	      <td>0.572359</td>
	      <td>2.318286</td>
	      <td>0.228572</td>
	      <td>0.709990</td>
	      <td>314.907474</td>
	    </tr>
	    <tr>
	      <th>min</th>
	      <td>11.030000</td>
	      <td>0.740000</td>
	      <td>1.360000</td>
	      <td>10.600000</td>
	      <td>70.000000</td>
	      <td>0.980000</td>
	      <td>0.340000</td>
	      <td>0.130000</td>
	      <td>0.410000</td>
	      <td>1.280000</td>
	      <td>0.480000</td>
	      <td>1.270000</td>
	      <td>278.000000</td>
	    </tr>
	    <tr>
	      <th>25%</th>
	      <td>12.362500</td>
	      <td>1.602500</td>
	      <td>2.210000</td>
	      <td>17.200000</td>
	      <td>88.000000</td>
	      <td>1.742500</td>
	      <td>1.205000</td>
	      <td>0.270000</td>
	      <td>1.250000</td>
	      <td>3.220000</td>
	      <td>0.782500</td>
	      <td>1.937500</td>
	      <td>500.500000</td>
	    </tr>
	    <tr>
	      <th>50%</th>
	      <td>13.050000</td>
	      <td>1.865000</td>
	      <td>2.360000</td>
	      <td>19.500000</td>
	      <td>98.000000</td>
	      <td>2.355000</td>
	      <td>2.135000</td>
	      <td>0.340000</td>
	      <td>1.555000</td>
	      <td>4.690000</td>
	      <td>0.965000</td>
	      <td>2.780000</td>
	      <td>673.500000</td>
	    </tr>
	    <tr>
	      <th>75%</th>
	      <td>13.677500</td>
	      <td>3.082500</td>
	      <td>2.557500</td>
	      <td>21.500000</td>
	      <td>107.000000</td>
	      <td>2.800000</td>
	      <td>2.875000</td>
	      <td>0.437500</td>
	      <td>1.950000</td>
	      <td>6.200000</td>
	      <td>1.120000</td>
	      <td>3.170000</td>
	      <td>985.000000</td>
	    </tr>
	    <tr>
	      <th>max</th>
	      <td>14.830000</td>
	      <td>5.800000</td>
	      <td>3.230000</td>
	      <td>30.000000</td>
	      <td>162.000000</td>
	      <td>3.880000</td>
	      <td>5.080000</td>
	      <td>0.660000</td>
	      <td>3.580000</td>
	      <td>13.000000</td>
	      <td>1.710000</td>
	      <td>4.000000</td>
	      <td>1680.000000</td>
	    </tr>
	  </tbody>
	</table>
</div>



Now, I wish I could visualize each point in 13-dimensional space, but I just can't. So, we need to find a way to reduce the dimensionality of our data. 

The na√Øve thing to do would be to check the correlation of some of the features and hope that some of them are repeats (can be removed). Let's try it out and display the correlation matrix.


```python
correlation = wine_df.corr()
correlation.style.background_gradient(cmap='coolwarm')
```
<div class="table">
	<style  type="text/css" >
    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row0_col0 {
            background-color:  #b40426;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row0_col1 {
            background-color:  #c6d6f1;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row0_col2 {
            background-color:  #93b5fe;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row0_col3 {
            background-color:  #5673e0;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row0_col4 {
            background-color:  #c6d6f1;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row0_col5 {
            background-color:  #dfdbd9;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row0_col6 {
            background-color:  #dddcdc;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row0_col7 {
            background-color:  #8caffe;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row0_col8 {
            background-color:  #b6cefa;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row0_col9 {
            background-color:  #f7ac8e;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row0_col10 {
            background-color:  #a3c2fe;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row0_col11 {
            background-color:  #bbd1f8;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row0_col12 {
            background-color:  #f4987a;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row1_col0 {
            background-color:  #a2c1ff;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row1_col1 {
            background-color:  #b40426;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row1_col2 {
            background-color:  #82a6fb;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row1_col3 {
            background-color:  #dedcdb;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row1_col4 {
            background-color:  #6e90f2;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row1_col5 {
            background-color:  #536edd;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row1_col6 {
            background-color:  #5470de;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row1_col7 {
            background-color:  #e7d7ce;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row1_col8 {
            background-color:  #5b7ae5;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row1_col9 {
            background-color:  #dedcdb;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row1_col10 {
            background-color:  #3b4cc0;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row1_col11 {
            background-color:  #5572df;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row1_col12 {
            background-color:  #7295f4;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row2_col0 {
            background-color:  #bfd3f6;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row2_col1 {
            background-color:  #d3dbe7;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row2_col2 {
            background-color:  #b40426;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row2_col3 {
            background-color:  #f3c7b1;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row2_col4 {
            background-color:  #cad8ef;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row2_col5 {
            background-color:  #c0d4f5;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row2_col6 {
            background-color:  #c7d7f0;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row2_col7 {
            background-color:  #d5dbe5;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row2_col8 {
            background-color:  #96b7ff;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row2_col9 {
            background-color:  #e0dbd8;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row2_col10 {
            background-color:  #a2c1ff;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row2_col11 {
            background-color:  #abc8fd;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row2_col12 {
            background-color:  #d3dbe7;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row3_col0 {
            background-color:  #3b4cc0;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row3_col1 {
            background-color:  #e8d6cc;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row3_col2 {
            background-color:  #d8dce2;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row3_col3 {
            background-color:  #b40426;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row3_col4 {
            background-color:  #6687ed;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row3_col5 {
            background-color:  #5572df;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row3_col6 {
            background-color:  #6180e9;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row3_col7 {
            background-color:  #efcebd;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row3_col8 {
            background-color:  #6180e9;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row3_col9 {
            background-color:  #b1cbfc;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row3_col10 {
            background-color:  #7699f6;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row3_col11 {
            background-color:  #6a8bef;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row3_col12 {
            background-color:  #3b4cc0;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row4_col0 {
            background-color:  #cdd9ec;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row4_col1 {
            background-color:  #a7c5fe;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row4_col2 {
            background-color:  #abc8fd;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row4_col3 {
            background-color:  #8caffe;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row4_col4 {
            background-color:  #b40426;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row4_col5 {
            background-color:  #d2dbe8;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row4_col6 {
            background-color:  #d7dce3;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row4_col7 {
            background-color:  #7597f6;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row4_col8 {
            background-color:  #ccd9ed;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row4_col9 {
            background-color:  #d6dce4;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row4_col10 {
            background-color:  #bfd3f6;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row4_col11 {
            background-color:  #b9d0f9;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row4_col12 {
            background-color:  #efcfbf;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row5_col0 {
            background-color:  #d2dbe8;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row5_col1 {
            background-color:  #688aef;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row5_col2 {
            background-color:  #779af7;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row5_col3 {
            background-color:  #5470de;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row5_col4 {
            background-color:  #b7cff9;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row5_col5 {
            background-color:  #b40426;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row5_col6 {
            background-color:  #d24b40;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row5_col7 {
            background-color:  #4b64d5;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row5_col8 {
            background-color:  #f7a688;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row5_col9 {
            background-color:  #a1c0ff;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row5_col10 {
            background-color:  #f5c0a7;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row5_col11 {
            background-color:  #ee8468;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row5_col12 {
            background-color:  #f6bda2;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row6_col0 {
            background-color:  #c5d6f2;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row6_col1 {
            background-color:  #5875e1;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row6_col2 {
            background-color:  #7396f5;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row6_col3 {
            background-color:  #4c66d6;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row6_col4 {
            background-color:  #b3cdfb;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row6_col5 {
            background-color:  #d44e41;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row6_col6 {
            background-color:  #b40426;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row6_col7 {
            background-color:  #3b4cc0;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row6_col8 {
            background-color:  #f59c7d;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row6_col9 {
            background-color:  #85a8fc;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row6_col10 {
            background-color:  #f7a98b;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row6_col11 {
            background-color:  #e26952;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row6_col12 {
            background-color:  #f6bda2;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row7_col0 {
            background-color:  #5f7fe8;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row7_col1 {
            background-color:  #e9d5cb;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row7_col2 {
            background-color:  #8badfd;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row7_col3 {
            background-color:  #ead4c8;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row7_col4 {
            background-color:  #3b4cc0;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row7_col5 {
            background-color:  #3b4cc0;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row7_col6 {
            background-color:  #3b4cc0;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row7_col7 {
            background-color:  #b40426;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row7_col8 {
            background-color:  #3b4cc0;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row7_col9 {
            background-color:  #cbd8ee;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row7_col10 {
            background-color:  #779af7;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row7_col11 {
            background-color:  #3b4cc0;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row7_col12 {
            background-color:  #5572df;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row8_col0 {
            background-color:  #adc9fd;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row8_col1 {
            background-color:  #81a4fb;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row8_col2 {
            background-color:  #536edd;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row8_col3 {
            background-color:  #7093f3;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row8_col4 {
            background-color:  #bed2f6;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row8_col5 {
            background-color:  #f5a081;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row8_col6 {
            background-color:  #f18f71;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row8_col7 {
            background-color:  #5d7ce6;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row8_col8 {
            background-color:  #b40426;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row8_col9 {
            background-color:  #a7c5fe;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row8_col10 {
            background-color:  #e9d5cb;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row8_col11 {
            background-color:  #f7b396;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row8_col12 {
            background-color:  #e6d7cf;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row9_col0 {
            background-color:  #f7bca1;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row9_col1 {
            background-color:  #e1dad6;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row9_col2 {
            background-color:  #a2c1ff;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row9_col3 {
            background-color:  #a5c3fe;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row9_col4 {
            background-color:  #b3cdfb;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row9_col5 {
            background-color:  #94b6ff;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row9_col6 {
            background-color:  #88abfd;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row9_col7 {
            background-color:  #ccd9ed;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row9_col8 {
            background-color:  #8caffe;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row9_col9 {
            background-color:  #b40426;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row9_col10 {
            background-color:  #4257c9;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row9_col11 {
            background-color:  #4961d2;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row9_col12 {
            background-color:  #e3d9d3;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row10_col0 {
            background-color:  #7597f6;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row10_col1 {
            background-color:  #3b4cc0;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row10_col2 {
            background-color:  #3b4cc0;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row10_col3 {
            background-color:  #5e7de7;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row10_col4 {
            background-color:  #8caffe;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row10_col5 {
            background-color:  #f3c8b2;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row10_col6 {
            background-color:  #f7aa8c;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row10_col7 {
            background-color:  #7396f5;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row10_col8 {
            background-color:  #d8dce2;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row10_col9 {
            background-color:  #3b4cc0;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row10_col10 {
            background-color:  #b40426;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row10_col11 {
            background-color:  #f7a889;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row10_col12 {
            background-color:  #d5dbe5;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row11_col0 {
            background-color:  #9bbcff;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row11_col1 {
            background-color:  #6180e9;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row11_col2 {
            background-color:  #506bda;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row11_col3 {
            background-color:  #5e7de7;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row11_col4 {
            background-color:  #8fb1fe;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row11_col5 {
            background-color:  #ee8669;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row11_col6 {
            background-color:  #e16751;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row11_col7 {
            background-color:  #4055c8;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row11_col8 {
            background-color:  #f6bea4;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row11_col9 {
            background-color:  #4c66d6;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row11_col10 {
            background-color:  #f6a586;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row11_col11 {
            background-color:  #b40426;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row11_col12 {
            background-color:  #e2dad5;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row12_col0 {
            background-color:  #f6a283;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row12_col1 {
            background-color:  #88abfd;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row12_col2 {
            background-color:  #97b8ff;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row12_col3 {
            background-color:  #3b4cc0;
            color:  #f1f1f1;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row12_col4 {
            background-color:  #e1dad6;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row12_col5 {
            background-color:  #f7bca1;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row12_col6 {
            background-color:  #f7b79b;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row12_col7 {
            background-color:  #688aef;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row12_col8 {
            background-color:  #dfdbd9;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row12_col9 {
            background-color:  #e9d5cb;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row12_col10 {
            background-color:  #dfdbd9;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row12_col11 {
            background-color:  #e7d7ce;
            color:  #000000;
        }    #T_e0d2697a_bb99_11e9_bb4d_c4b301962064row12_col12 {
            background-color:  #b40426;
            color:  #f1f1f1;
        }</style><table id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >alcohol</th>        <th class="col_heading level0 col1" >malic_acid</th>        <th class="col_heading level0 col2" >ash</th>        <th class="col_heading level0 col3" >alcalinity_of_ash</th>        <th class="col_heading level0 col4" >magnesium</th>        <th class="col_heading level0 col5" >total_phenols</th>        <th class="col_heading level0 col6" >flavanoids</th>        <th class="col_heading level0 col7" >nonflavanoid_phenols</th>        <th class="col_heading level0 col8" >proanthocyanins</th>        <th class="col_heading level0 col9" >color_intensity</th>        <th class="col_heading level0 col10" >hue</th>        <th class="col_heading level0 col11" >od280/od315_of_diluted_wines</th>        <th class="col_heading level0 col12" >proline</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064level0_row0" class="row_heading level0 row0" >alcohol</th>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row0_col0" class="data row0 col0" >1</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row0_col1" class="data row0 col1" >0.0943969</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row0_col2" class="data row0 col2" >0.211545</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row0_col3" class="data row0 col3" >-0.310235</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row0_col4" class="data row0 col4" >0.270798</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row0_col5" class="data row0 col5" >0.289101</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row0_col6" class="data row0 col6" >0.236815</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row0_col7" class="data row0 col7" >-0.155929</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row0_col8" class="data row0 col8" >0.136698</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row0_col9" class="data row0 col9" >0.546364</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row0_col10" class="data row0 col10" >-0.0717472</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row0_col11" class="data row0 col11" >0.0723432</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row0_col12" class="data row0 col12" >0.64372</td>
            </tr>
            <tr>
                        <th id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064level0_row1" class="row_heading level0 row1" >malic_acid</th>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row1_col0" class="data row1 col0" >0.0943969</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row1_col1" class="data row1 col1" >1</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row1_col2" class="data row1 col2" >0.164045</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row1_col3" class="data row1 col3" >0.2885</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row1_col4" class="data row1 col4" >-0.0545751</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row1_col5" class="data row1 col5" >-0.335167</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row1_col6" class="data row1 col6" >-0.411007</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row1_col7" class="data row1 col7" >0.292977</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row1_col8" class="data row1 col8" >-0.220746</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row1_col9" class="data row1 col9" >0.248985</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row1_col10" class="data row1 col10" >-0.561296</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row1_col11" class="data row1 col11" >-0.36871</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row1_col12" class="data row1 col12" >-0.192011</td>
            </tr>
            <tr>
                        <th id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064level0_row2" class="row_heading level0 row2" >ash</th>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row2_col0" class="data row2 col0" >0.211545</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row2_col1" class="data row2 col1" >0.164045</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row2_col2" class="data row2 col2" >1</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row2_col3" class="data row2 col3" >0.443367</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row2_col4" class="data row2 col4" >0.286587</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row2_col5" class="data row2 col5" >0.12898</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row2_col6" class="data row2 col6" >0.115077</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row2_col7" class="data row2 col7" >0.18623</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row2_col8" class="data row2 col8" >0.00965194</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row2_col9" class="data row2 col9" >0.258887</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row2_col10" class="data row2 col10" >-0.0746669</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row2_col11" class="data row2 col11" >0.00391123</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row2_col12" class="data row2 col12" >0.223626</td>
            </tr>
            <tr>
                        <th id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064level0_row3" class="row_heading level0 row3" >alcalinity_of_ash</th>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row3_col0" class="data row3 col0" >-0.310235</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row3_col1" class="data row3 col1" >0.2885</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row3_col2" class="data row3 col2" >0.443367</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row3_col3" class="data row3 col3" >1</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row3_col4" class="data row3 col4" >-0.0833331</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row3_col5" class="data row3 col5" >-0.321113</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row3_col6" class="data row3 col6" >-0.35137</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row3_col7" class="data row3 col7" >0.361922</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row3_col8" class="data row3 col8" >-0.197327</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row3_col9" class="data row3 col9" >0.018732</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row3_col10" class="data row3 col10" >-0.273955</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row3_col11" class="data row3 col11" >-0.276769</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row3_col12" class="data row3 col12" >-0.440597</td>
            </tr>
            <tr>
                        <th id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064level0_row4" class="row_heading level0 row4" >magnesium</th>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row4_col0" class="data row4 col0" >0.270798</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row4_col1" class="data row4 col1" >-0.0545751</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row4_col2" class="data row4 col2" >0.286587</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row4_col3" class="data row4 col3" >-0.0833331</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row4_col4" class="data row4 col4" >1</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row4_col5" class="data row4 col5" >0.214401</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row4_col6" class="data row4 col6" >0.195784</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row4_col7" class="data row4 col7" >-0.256294</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row4_col8" class="data row4 col8" >0.236441</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row4_col9" class="data row4 col9" >0.19995</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row4_col10" class="data row4 col10" >0.0553982</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row4_col11" class="data row4 col11" >0.0660039</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row4_col12" class="data row4 col12" >0.393351</td>
            </tr>
            <tr>
                        <th id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064level0_row5" class="row_heading level0 row5" >total_phenols</th>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row5_col0" class="data row5 col0" >0.289101</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row5_col1" class="data row5 col1" >-0.335167</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row5_col2" class="data row5 col2" >0.12898</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row5_col3" class="data row5 col3" >-0.321113</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row5_col4" class="data row5 col4" >0.214401</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row5_col5" class="data row5 col5" >1</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row5_col6" class="data row5 col6" >0.864564</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row5_col7" class="data row5 col7" >-0.449935</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row5_col8" class="data row5 col8" >0.612413</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row5_col9" class="data row5 col9" >-0.0551364</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row5_col10" class="data row5 col10" >0.433681</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row5_col11" class="data row5 col11" >0.699949</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row5_col12" class="data row5 col12" >0.498115</td>
            </tr>
            <tr>
                        <th id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064level0_row6" class="row_heading level0 row6" >flavanoids</th>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row6_col0" class="data row6 col0" >0.236815</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row6_col1" class="data row6 col1" >-0.411007</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row6_col2" class="data row6 col2" >0.115077</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row6_col3" class="data row6 col3" >-0.35137</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row6_col4" class="data row6 col4" >0.195784</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row6_col5" class="data row6 col5" >0.864564</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row6_col6" class="data row6 col6" >1</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row6_col7" class="data row6 col7" >-0.5379</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row6_col8" class="data row6 col8" >0.652692</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row6_col9" class="data row6 col9" >-0.172379</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row6_col10" class="data row6 col10" >0.543479</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row6_col11" class="data row6 col11" >0.787194</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row6_col12" class="data row6 col12" >0.494193</td>
            </tr>
            <tr>
                        <th id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064level0_row7" class="row_heading level0 row7" >nonflavanoid_phenols</th>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row7_col0" class="data row7 col0" >-0.155929</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row7_col1" class="data row7 col1" >0.292977</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row7_col2" class="data row7 col2" >0.18623</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row7_col3" class="data row7 col3" >0.361922</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row7_col4" class="data row7 col4" >-0.256294</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row7_col5" class="data row7 col5" >-0.449935</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row7_col6" class="data row7 col6" >-0.5379</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row7_col7" class="data row7 col7" >1</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row7_col8" class="data row7 col8" >-0.365845</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row7_col9" class="data row7 col9" >0.139057</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row7_col10" class="data row7 col10" >-0.26264</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row7_col11" class="data row7 col11" >-0.50327</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row7_col12" class="data row7 col12" >-0.311385</td>
            </tr>
            <tr>
                        <th id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064level0_row8" class="row_heading level0 row8" >proanthocyanins</th>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row8_col0" class="data row8 col0" >0.136698</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row8_col1" class="data row8 col1" >-0.220746</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row8_col2" class="data row8 col2" >0.00965194</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row8_col3" class="data row8 col3" >-0.197327</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row8_col4" class="data row8 col4" >0.236441</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row8_col5" class="data row8 col5" >0.612413</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row8_col6" class="data row8 col6" >0.652692</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row8_col7" class="data row8 col7" >-0.365845</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row8_col8" class="data row8 col8" >1</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row8_col9" class="data row8 col9" >-0.0252499</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row8_col10" class="data row8 col10" >0.295544</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row8_col11" class="data row8 col11" >0.519067</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row8_col12" class="data row8 col12" >0.330417</td>
            </tr>
            <tr>
                        <th id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064level0_row9" class="row_heading level0 row9" >color_intensity</th>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row9_col0" class="data row9 col0" >0.546364</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row9_col1" class="data row9 col1" >0.248985</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row9_col2" class="data row9 col2" >0.258887</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row9_col3" class="data row9 col3" >0.018732</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row9_col4" class="data row9 col4" >0.19995</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row9_col5" class="data row9 col5" >-0.0551364</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row9_col6" class="data row9 col6" >-0.172379</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row9_col7" class="data row9 col7" >0.139057</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row9_col8" class="data row9 col8" >-0.0252499</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row9_col9" class="data row9 col9" >1</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row9_col10" class="data row9 col10" >-0.521813</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row9_col11" class="data row9 col11" >-0.428815</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row9_col12" class="data row9 col12" >0.3161</td>
            </tr>
            <tr>
                        <th id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064level0_row10" class="row_heading level0 row10" >hue</th>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row10_col0" class="data row10 col0" >-0.0717472</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row10_col1" class="data row10 col1" >-0.561296</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row10_col2" class="data row10 col2" >-0.0746669</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row10_col3" class="data row10 col3" >-0.273955</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row10_col4" class="data row10 col4" >0.0553982</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row10_col5" class="data row10 col5" >0.433681</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row10_col6" class="data row10 col6" >0.543479</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row10_col7" class="data row10 col7" >-0.26264</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row10_col8" class="data row10 col8" >0.295544</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row10_col9" class="data row10 col9" >-0.521813</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row10_col10" class="data row10 col10" >1</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row10_col11" class="data row10 col11" >0.565468</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row10_col12" class="data row10 col12" >0.236183</td>
            </tr>
            <tr>
                        <th id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064level0_row11" class="row_heading level0 row11" >od280/od315_of_diluted_wines</th>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row11_col0" class="data row11 col0" >0.0723432</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row11_col1" class="data row11 col1" >-0.36871</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row11_col2" class="data row11 col2" >0.00391123</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row11_col3" class="data row11 col3" >-0.276769</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row11_col4" class="data row11 col4" >0.0660039</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row11_col5" class="data row11 col5" >0.699949</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row11_col6" class="data row11 col6" >0.787194</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row11_col7" class="data row11 col7" >-0.50327</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row11_col8" class="data row11 col8" >0.519067</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row11_col9" class="data row11 col9" >-0.428815</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row11_col10" class="data row11 col10" >0.565468</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row11_col11" class="data row11 col11" >1</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row11_col12" class="data row11 col12" >0.312761</td>
            </tr>
            <tr>
                        <th id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064level0_row12" class="row_heading level0 row12" >proline</th>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row12_col0" class="data row12 col0" >0.64372</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row12_col1" class="data row12 col1" >-0.192011</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row12_col2" class="data row12 col2" >0.223626</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row12_col3" class="data row12 col3" >-0.440597</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row12_col4" class="data row12 col4" >0.393351</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row12_col5" class="data row12 col5" >0.498115</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row12_col6" class="data row12 col6" >0.494193</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row12_col7" class="data row12 col7" >-0.311385</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row12_col8" class="data row12 col8" >0.330417</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row12_col9" class="data row12 col9" >0.3161</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row12_col10" class="data row12 col10" >0.236183</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row12_col11" class="data row12 col11" >0.312761</td>
                        <td id="T_e0d2697a_bb99_11e9_bb4d_c4b301962064row12_col12" class="data row12 col12" >1</td>
            </tr>
    </tbody></table>
</div>


The correlation between ``flavanoids`` and ``total_phenols`` is pretty high (86%), so we might be able to remove that feature from our dataset. However, that would still leave us with 12 dimensions which we cannot visualize. 

Obviously, this approach isn't very good, but it was a great start. At this step, I would encourage you to think about how we could improve this approach and build off of it.

## Dimensionality Reduction with PCA
Now, I'll present Principal Component Analysis (PCA). It stems from the experiment that we have just conducted, 

There was a flaw in our last experiment that I hope you might have caught. We should have **normalized** our data first (scaling all the values to be between 0 and 1). This step is important, because the PCA algorithm relies on the variance of each feature. If one feature ranges from 0 to 100 in value, while another feature ranges from 0 to 1, the first feature would over-shadow the second.

The normalization follows this formula:
$$ new\text{ }value = \frac{value - mean}{standard\text{ }deviation} $$


```python
from sklearn.preprocessing import StandardScaler
std_wine = StandardScaler().fit_transform(wine_df) # normalizing the data 
```

Sci-kit learn makes it very easy to get the principal components.


```python
pca = PCA(n_components=13)
principalComponents = pca.fit_transform(std_wine)
```

In our last experiment we were removing variables that were highly correlated. With PCA, however, we are trying to compute new characteristics (principal components) that compacts the information into certain dimensions.

Behind the scenes, the algorithm will first get the covariance matrix similarly to what we have done previously. Then, it will calculate the ``Principal Components (PCs)``. If our datapoints have 13 variables, then we will get 13 PCs. A PC is a linear combination of the variables such that they have no correlation with each other (they are orthogonal) and that most of the information is squeezed into the first few PCs. In this case, "information" is the variance. 

In our example, here is the variance captured in each principal component:


```python
# Plotting the variances for each PC
PC = range(1, pca.n_components_+1)
plt.bar(PC, pca.explained_variance_ratio_, color='gold')
plt.xlabel('Principal Components')
plt.ylabel('Variance %')
plt.xticks(PC)

# Putting components in a dataframe for later
PCA_components = pd.DataFrame(principalComponents)
```

<img src="/Media/blog/pca/output_16_0.png">

Like I said, most of the variance is put in the first component. What is left is put in component 2, then component 3, etc. 

To explain how it works, let's look at an image.

<img src="/Media/blog/pca/ani.gif">

In the animation above, the datapoints are 2d, so there will be 2 principal components. The black line is the 1st principal component (PC1) and it's proper position would be along the two magenta markers. Consider the projections of each point onto PC1 (the red dots). When PC1 is in the proper position, the red dots are the farthest away from each other. This is how we squeeze the most variance into the PC ‚Äî by maximizing the distance between the red dots.

Then, PC2 is shown in gray. It is found in the same way, except it is constrained to be orthogonal to PC1. This constraint ensures that the components are not correlated with each other. Moreover, it should be noted that the animation also illustrates how the first PCs have the highest variance.

Now that we have the intuition, let's proceed with the implementation. From the variance plot I showed earlier, there wasn't much variance contained in the third component, so let's just plot the first 2.


```python
plt.scatter(PCA_components[0], PCA_components[1], alpha=.3, color='gold')
plt.xlabel('PCA 1')
plt.ylabel('PCA 2')
plt.show()
```

<img src="/Media/blog/pca/output_20_0.png">

Awesome, PCA has helped us to reduce the dimension of our data and we were able to make this nice plot. Even more interesting is that it looks like there are 3 clusters of wine present.

## Clustering ‚Äî K-means
To make the clusters more apparent, let's use the K-means clustering algorithm to color-code them. I don't want this post to get too heavy so I won't be explaining the intuition behind this one.

We first need to determine how many clusters we want. By visual inspection, I think there are 3, but for completeness, we will use ``inertia`` to help us with this decision.


```python
inertias = []

# Creating 10 K-Mean models while varying the number of clusters (k)
for k in range(1,10):
    model = KMeans(n_clusters=k)
    
    # Fit model to samples
    model.fit(PCA_components.iloc[:,:3])
    
    # Append the inertia to the list of inertias
    inertias.append(model.inertia_)
    
plt.plot(range(1,10), inertias, '-p', color='gold')
plt.xlabel('number of clusters, k')
plt.ylabel('inertia')
plt.xticks(ks)
plt.show()
```



<img src="/Media/blog/pca/output_22_0.png">

Typically, we look at these inertia plots to find the elbow point. In our case, it looks like the elbow occurs with 3 clusters, so we will proceed with that.

So, let's create our final model with 3 clusters on PC1 and PC2:


```python
model = KMeans(n_clusters=3)
model.fit(PCA_components.iloc[:,:2])

labels = model.predict(PCA_components.iloc[:,:2])
plt.scatter(PCA_components[0], PCA_components[1], c=labels)
plt.show()
```


<img src="/Media/blog/pca/output_24_0.png">


Looks great! Congratulations on learning about PCA and performing unsupervised classification on your data. The next step would be to determine the meaning of these clusters. Maybe it's red wine vs white wine vs other? Alternatively, it might represent something completely different and you can invent your own labels.

I hope this post was helpful and I would be happy to answer any questions you might have. My contact info is available below.
